<!DOCTYPE html>
<html>
<head>
  <!-- Include Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <style>
    .full-width {
      width: 100%;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Create Table</h2>
    <div class="form-row">
      <div class="form-group col-md-4">
        <label for="nameInput">Name:</label>
        <input type="text" class="form-control" id="nameInput" required>
      </div>
      <div class="form-group col-md-4">
        <label for="addressInput">Address:</label>
        <input type="text" class="form-control" id="addressInput" required>
      </div>
      <div class="form-group col-md-4">
        <label for="contactInput">Contact:</label>
        <input type="number" class="form-control" id="contactInput" required max="999999999999">
      </div>
    </div>
    <button type="submit" class="btn btn-primary full-width" onclick="addRow()">Add Row</button>

    <div class="form-row mt-4">
      <div class="form-group col-md-8">
        <input type="text" class="form-control" id="columnNameInput" placeholder="Column Name" required>
      </div>
      <div class="form-group col-md-4">
        <button class="btn btn-primary full-width" onclick="addColumn()">Add Column</button>
      </div>
    </div>

    <table id="dataTable" class="table mt-4">
      <thead>
        <tr>
          <th>Name</th>
          <th>Address</th>
          <th>Contact</th>
        </tr>
      </thead>
      <tbody>
      </tbody>
    </table>

    <button onclick="exportToExcel()" class="btn btn-success full-width" id="exportButton" disabled>Export to Excel</button>
  </div>

  <!-- Include required libraries -->
  <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
  <script src="https://unpkg.com/file-saver/dist/FileSaver.min.js"></script>

  <script>
    function addRow() {
      const nameInput = document.getElementById("nameInput");
      const addressInput = document.getElementById("addressInput");
      const contactInput = document.getElementById("contactInput");

      if (nameInput.value.trim() !== "" && addressInput.value.trim() !== "" && contactInput.value.trim() !== "") {
        const tableBody = document.getElementById("dataTable").getElementsByTagName("tbody")[0];
        const newRow = tableBody.insertRow();

        const nameCell = newRow.insertCell();
        const addressCell = newRow.insertCell();
        const contactCell = newRow.insertCell();

        nameCell.innerHTML = nameInput.value.trim();
        addressCell.innerHTML = addressInput.value.trim();
        contactCell.innerHTML = contactInput.value.trim();

        nameInput.value = "";
        addressInput.value = "";
        contactInput.value = "";

        updateExportButtonState();
      }
    }

    function addColumn() {
      const columnNameInput = document.getElementById("columnNameInput").value.trim();

      if (columnNameInput !== "") {
        const table = document.getElementById("dataTable");
        const tableHead = table.getElementsByTagName("thead")[0];
        const tableBody = table.getElementsByTagName("tbody")[0];
        const columnCount = tableHead.rows[0].cells.length;

        // Update table header
        const newHeaderCell = tableHead.rows[0].insertCell(columnCount);
        newHeaderCell.innerHTML = columnNameInput;

        // Update existing rows
        const rows = tableBody.getElementsByTagName("tr");
        for (let i = 0; i < rows.length; i++) {
          const newRowCell = rows[i].insertCell(columnCount);
          newRowCell.innerHTML = "";
        }

        document.getElementById("columnNameInput").value = "";

        updateExportButtonState();
      }
    }

    function updateExportButtonState() {
      const table = document.getElementById("dataTable");
      const exportButton = document.getElementById("exportButton");

      if (table.rows.length > 1) {
        exportButton.disabled = false;
      } else {
        exportButton.disabled = true;
      }
    }

    function exportToExcel() {
      const table = document.getElementById("dataTable");
      const workbook = XLSX.utils.table_to_book(table, { sheet: "Sheet 1" });
      const excelBuffer = XLSX.write(workbook, { bookType: "xlsx", type: "array" });
      const excelData = new Blob([excelBuffer], { type: "application/octet-stream" });
      const dateTime = new Date().toISOString().replace(/[-:.]/g, "");
      saveAs(excelData, "table_" + dateTime + ".xlsx");
    }
  </script>
</body>
</html>
